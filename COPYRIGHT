The code originates from replies to this Stack Overflow question:
http://stackoverflow.com/q/1298867/877377

It has been then modified to take into account retina display support.
